<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="http://jonnyreeves.co.uk/theme/css/style.min.css">
  <link rel="stylesheet" type="text/css" href="http://jonnyreeves.co.uk/theme/css/pygments.min.css">
  <link rel="stylesheet" type="text/css" href="http://jonnyreeves.co.uk/theme/css/font-awesome.min.css">
  <link href="http://jonnyreeves.co.uk/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Jonny Reeves Atom">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />
<meta name="author" content="Jonny Reeves" />
<meta name="description" content="Webpack 2 is just around the corner with the promise of easier command line configuration, however whilst we're stuck with webpack 1, here's an easy way to split you configuration between your development flow (with hot-module-reloading) and production (with minification). The trick revolves around the fact that webpack ..." />
<meta name="keywords" content="">
<meta property="og:site_name" content="Jonny Reeves"/>
<meta property="og:title" content="Simple Webpack Prod and Dev Config"/>
<meta property="og:description" content="Webpack 2 is just around the corner with the promise of easier command line configuration, however whilst we're stuck with webpack 1, here's an easy way to split you configuration between your development flow (with hot-module-reloading) and production (with minification). The trick revolves around the fact that webpack ..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="http://jonnyreeves.co.uk/2016/simple-webpack-prod-and-dev-config/"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2016-02-29 21:00:00+00:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="http://jonnyreeves.co.uk/author/jonny-reeves.html">
<meta property="article:section" content="2016"/>
<meta property="og:image" content="/images/avatar.jpg">  <title>Jonny Reeves &ndash; Simple Webpack Prod and Dev Config</title>
</head>
<body>
  <aside>
    <div>
      <a href="http://jonnyreeves.co.uk">
        <img src="/images/avatar.jpg" alt="Jonny Reeves" title="Jonny Reeves">
      </a>
      <h1><a href="http://jonnyreeves.co.uk">Jonny Reeves</a></h1>
      <p>code && coffee || music</p>
      <nav>
        <ul class="list">
        </ul>
      </nav>
      <ul class="social">
        <li><a class="sc-linkedin" href="https://br.linkedin.com/in/jonnyreeves/en" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-google" href="https://plus.google.com/+JohnReeves" target="_blank"><i class="fa fa-google"></i></a></li>
        <li><a class="sc-stack-overflow" href="http://stackoverflow.com/users/227349/jonnyreeves" target="_blank"><i class="fa fa-stack-overflow"></i></a></li>
        <li><a class="sc-github" href="https://github.com/jonnyreeves" target="_blank"><i class="fa fa-github"></i></a></li>
      </ul>
    </div>
  </aside>
  <main>

<article>
  <header>
    <h1 id="simple-webpack-prod-and-dev-config">Simple Webpack Prod and Dev Config</h1>
    <p>Posted on Mon 29 February 2016 in <a href="http://jonnyreeves.co.uk/category/2016.html">2016</a></p>
  </header>
  <div>
    <p>Webpack 2 is just around the corner with the <a href="https://gist.github.com/sokra/27b24881210b56bbaff7#configuration">promise of easier command line configuration</a>, however whilst we're stuck with webpack 1, here's an easy way to split you configuration between your development flow (with hot-module-reloading) and production (with minification).</p>
<p>The trick revolves around the fact that webpack configuration can be a CommonJS module and can pick up on environment variables via Node's <code>process.env</code> object.</p>
<p>Start by modifying your <code>webpack.config.js</code> file (typically in the root of your project, next to your <code>package.json</code> file) to look something like this:</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">webpack</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;webpack&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">isProd</span> <span class="o">=</span> <span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">===</span> <span class="s1">&#39;production&#39;</span><span class="p">);</span>

<span class="c1">// Conditionally return a list of plugins to use based on the current environment.</span>
<span class="c1">// Repeat this pattern for any other config key (ie: loaders, etc).</span>
<span class="kd">function</span> <span class="nx">getPlugins</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">plugins</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="c1">// Always expose NODE_ENV to webpack, you can now use `process.env.NODE_ENV`</span>
  <span class="c1">// inside your code for any environment checks; UglifyJS will automatically</span>
  <span class="c1">// drop any unreachable code.</span>
  <span class="nx">plugins</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">DefinePlugin</span><span class="p">({</span>
    <span class="s1">&#39;process.env&#39;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s1">&#39;NODE_ENV&#39;</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span>
    <span class="p">}</span>
  <span class="p">}));</span>

  <span class="c1">// Conditionally add plugins for Production builds.</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">isProd</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">plugins</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">optimize</span><span class="p">.</span><span class="nx">UglifyJsPlugin</span><span class="p">());</span>
  <span class="p">}</span>

  <span class="c1">// Conditionally add plugins for Development</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">plugins</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Export Webpack configuration.</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">plugins</span><span class="o">:</span> <span class="nx">getPlugins</span><span class="p">()</span>
<span class="p">};</span>
</pre></div>


<p>With this in place you can now set the <code>NODE_ENV</code> environment variable before invoking webpack's command line tool:</p>
<div class="highlight"><pre><span></span>NODE_ENV=production webpack
</pre></div>


<p>If you are using <a href="http://blog.keithcirkel.co.uk/why-we-should-stop-using-grunt/">npm scripts for your build process</a>, you can add a <code>start</code> script to spin up your hot-loading development server and a <code>dist</code> script for creating your distribution assets for production. (note there's no need to set the <code>NODE_ENV</code> environment variable outside of production as an empty (<code>undefined</code>) value will default to false in your webpack config):</p>
<div class="highlight"><pre><span></span>&quot;scripts&quot;: {
  &quot;dist&quot;: &quot;NODE_ENV=production webpack&quot;,
  &quot;start&quot;: &quot;webpack&quot;,
}
</pre></div>
  </div>
  <div class="tag-cloud">
    <p>
    </p>
  </div>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'jonnyreeves';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</article>

    <footer>
      <p>&copy; Jonny Reeves </p>
<p>Built using <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a></p>    </footer>
  </main>
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-30309890-1', 'auto');
  ga('send', 'pageview');
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "name": "Simple Webpack Prod and Dev Config",
  "headline": "Simple Webpack Prod and Dev Config",
  "datePublished": "2016-02-29 21:00:00+00:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Jonny Reeves",
    "url": "http://jonnyreeves.co.uk/author/jonny-reeves.html"
  },
  "image": "/images/avatar.jpg",
  "url": "http://jonnyreeves.co.uk/2016/simple-webpack-prod-and-dev-config/",
  "description": "Webpack 2 is just around the corner with the promise of easier command line configuration, however whilst we're stuck with webpack 1, here's an easy way to split you configuration between your development flow (with hot-module-reloading) and production (with minification). The trick revolves around the fact that webpack ..."
}
</script></body>
</html>